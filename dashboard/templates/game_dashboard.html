<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ game.name }} - ê²Œì„ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .card { transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(0,0,0,0.1); }
        .filter-section { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- í—¤ë” -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <a href="/" class="text-blue-200 hover:text-white text-sm mb-2 inline-block">
                        â† ê²Œì„ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                    </a>
                    <h1 class="text-3xl font-bold">ğŸ® {{ game.name }}</h1>
                    <p class="text-blue-200 mt-1">{{ game.keyword }} ì»¤ë®¤ë‹ˆí‹° ë¶„ì„</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-blue-200">ìµœê·¼ ì—…ë°ì´íŠ¸</p>
                    <p class="text-lg font-semibold">{{ game.latest_date[:10] if game.latest_date else '-' }}</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Hot Issue ì•Œë¦¼ ë°°ë„ˆ -->
    <div id="hot-issue-banner" class="hidden">
        <div class="bg-gradient-to-r from-red-600 to-orange-600 text-white py-3 shadow-lg">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <span class="text-2xl mr-3 animate-pulse">ğŸ”¥</span>
                        <div>
                            <p id="hot-issue-message" class="font-semibold">ê¸´ê¸‰ ì´ìŠˆê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!</p>
                            <p id="hot-issue-detail" class="text-sm text-red-100 mt-0.5"></p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="scrollToIssues()" class="px-4 py-1.5 bg-white text-red-600 text-sm font-medium rounded-md hover:bg-red-50 transition-colors">
                            ì´ìŠˆ í™•ì¸
                        </button>
                        <button onclick="dismissHotIssueBanner()" class="text-white hover:text-red-200 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- ê´€ë ¨ ê²Œì‹œê¸€ ë§í¬ -->
                <div id="hot-issue-posts" class="mt-2 hidden">
                    <div class="flex flex-wrap gap-2 text-sm">
                        <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ê¸´ê¸‰ ì•Œë¦¼ ë°°ë„ˆ (Requirements 8.4) -->
    <div id="urgent-alert-banner" class="hidden">
        <div class="bg-gradient-to-r from-purple-700 to-pink-600 text-white py-3 shadow-lg">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <span class="text-2xl mr-3 animate-bounce">ğŸš¨</span>
                        <div>
                            <p id="urgent-alert-message" class="font-semibold">ê¸´ê¸‰ ì•Œë¦¼!</p>
                            <p id="urgent-alert-detail" class="text-sm text-purple-100 mt-0.5"></p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="scrollToAlerts()" class="px-4 py-1.5 bg-white text-purple-600 text-sm font-medium rounded-md hover:bg-purple-50 transition-colors">
                            ì•Œë¦¼ í™•ì¸
                        </button>
                        <button onclick="dismissUrgentAlertBanner()" class="text-white hover:text-purple-200 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¶€ì •ì  ê°ì„± ê¸‰ì¦ ê²½ê³  ë°°ë„ˆ (Requirements 8.2) -->
    <div id="sentiment-spike-banner" class="hidden">
        <div class="bg-gradient-to-r from-yellow-600 to-amber-600 text-white py-3 shadow-lg">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <span class="text-2xl mr-3">âš ï¸</span>
                        <div>
                            <p id="sentiment-spike-message" class="font-semibold">ë¶€ì •ì  ê°ì„± ê¸‰ì¦ ê°ì§€!</p>
                            <p id="sentiment-spike-detail" class="text-sm text-yellow-100 mt-0.5"></p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="scrollToTrend()" class="px-4 py-1.5 bg-white text-yellow-600 text-sm font-medium rounded-md hover:bg-yellow-50 transition-colors">
                            íŠ¸ë Œë“œ í™•ì¸
                        </button>
                        <button onclick="dismissSentimentSpikeBanner()" class="text-white hover:text-yellow-200 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <main class="container mx-auto px-4 py-8">
        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="card bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 bg-blue-100 rounded-full">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-gray-500 text-sm">ê²Œì‹œê¸€ ìˆ˜</p>
                        <p class="text-2xl font-bold text-gray-800">{{ "{:,}".format(stats.total_posts) }}</p>
                    </div>
                </div>
            </div>

            <div class="card bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 bg-purple-100 rounded-full">
                        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-gray-500 text-sm">ì´ ì¡°íšŒìˆ˜</p>
                        <p class="text-2xl font-bold text-gray-800">{{ "{:,}".format(stats.total_views) }}</p>
                    </div>
                </div>
            </div>
            
            <div class="card bg-white rounded-lg shadow-md p-6">
                <div class="flex items-center">
                    <div class="p-3 bg-green-100 rounded-full">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-gray-500 text-sm">ì´ ëŒ“ê¸€</p>
                        <p class="text-2xl font-bold text-gray-800">{{ "{:,}".format(stats.total_comments) }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê°ì„± ë¶„ì„ ì„¹ì…˜ -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8" id="sentiment-section">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-bold text-gray-800">ğŸ˜Š ê°ì„± ë¶„ì„</h2>
                <button onclick="loadSentimentData()" class="px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    ë¶„ì„ ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
            
            <div id="sentiment-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                <p class="text-gray-500 mt-2">ê°ì„± ë¶„ì„ ì¤‘...</p>
            </div>
            
            <div id="sentiment-content" class="hidden">
                <!-- ê°ì„± ë¶„í¬ ìš”ì•½ -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <!-- í‰ê·  ê°ì„± ì ìˆ˜ -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-indigo-600 font-medium">í‰ê·  ê°ì„± ì ìˆ˜</p>
                        <p id="sentiment-avg" class="text-3xl font-bold text-indigo-700 mt-1">-</p>
                        <p id="sentiment-avg-label" class="text-xs text-indigo-500 mt-1">-</p>
                    </div>
                    
                    <!-- ê¸ì • -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-green-600 font-medium">ğŸ˜Š ê¸ì •</p>
                        <p id="sentiment-positive" class="text-3xl font-bold text-green-700 mt-1">-</p>
                        <p id="sentiment-positive-pct" class="text-xs text-green-500 mt-1">-</p>
                    </div>
                    
                    <!-- ì¤‘ë¦½ -->
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-gray-600 font-medium">ğŸ˜ ì¤‘ë¦½</p>
                        <p id="sentiment-neutral" class="text-3xl font-bold text-gray-700 mt-1">-</p>
                        <p id="sentiment-neutral-pct" class="text-xs text-gray-500 mt-1">-</p>
                    </div>
                    
                    <!-- ë¶€ì • -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-red-600 font-medium">ğŸ˜  ë¶€ì •</p>
                        <p id="sentiment-negative" class="text-3xl font-bold text-red-700 mt-1">-</p>
                        <p id="sentiment-negative-pct" class="text-xs text-red-500 mt-1">-</p>
                    </div>
                </div>
                
                <!-- ê°ì„± ë¶„í¬ ì°¨íŠ¸ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-sm font-medium text-gray-700 mb-3">ê°ì„± ë¶„í¬ ì°¨íŠ¸</h3>
                        <div class="relative" style="height: 200px;">
                            <canvas id="sentiment-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="text-sm font-medium text-gray-700 mb-3">ê°ì„± ë¹„ìœ¨ ë°”</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-green-600">ê¸ì •</span>
                                    <span id="bar-positive-pct" class="text-green-600">-</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div id="bar-positive" class="bg-green-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-gray-600">ì¤‘ë¦½</span>
                                    <span id="bar-neutral-pct" class="text-gray-600">-</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div id="bar-neutral" class="bg-gray-400 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="text-red-600">ë¶€ì •</span>
                                    <span id="bar-negative-pct" class="text-red-600">-</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4">
                                    <div id="bar-negative" class="bg-red-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ë¶€ì •ì  ê²Œì‹œê¸€ ëª©ë¡ -->
                <div class="border-t pt-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">âš ï¸ ë¶€ì •ì  ê²Œì‹œê¸€ (ê°ì„± ì ìˆ˜ -0.3 ë¯¸ë§Œ)</h3>
                    <div id="negative-posts-container">
                        <div id="negative-posts-empty" class="text-center py-8 text-gray-500 hidden">
                            ë¶€ì •ì ì¸ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ğŸ‘
                        </div>
                        <div id="negative-posts-list" class="space-y-2">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="sentiment-error" class="hidden text-center py-8">
                <svg class="w-12 h-12 text-red-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-red-500">ê°ì„± ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                <button onclick="loadSentimentData()" class="mt-2 text-blue-600 hover:underline">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        </div>

        <!-- íŠ¸ë Œë“œ ë¶„ì„ ì„¹ì…˜ -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8" id="trend-section">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-bold text-gray-800">ğŸ“ˆ íŠ¸ë Œë“œ ë¶„ì„</h2>
                <div class="flex items-center gap-3">
                    <select id="trend-period" onchange="loadTrendData()" class="px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="daily">ì¼ë³„</option>
                        <option value="weekly">ì£¼ë³„</option>
                    </select>
                    <button onclick="loadTrendData()" class="px-4 py-2 bg-indigo-600 text-white text-sm rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        ìƒˆë¡œê³ ì¹¨
                    </button>
                </div>
            </div>
            
            <div id="trend-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>
                <p class="text-gray-500 mt-2">íŠ¸ë Œë“œ ë¶„ì„ ì¤‘...</p>
            </div>
            
            <div id="trend-content" class="hidden">
                <!-- íŠ¸ë Œë“œ ìš”ì•½ -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-indigo-600 font-medium">í‰ê·  ê°ì„±</p>
                        <p id="trend-avg" class="text-2xl font-bold text-indigo-700 mt-1">-</p>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-green-600 font-medium">ìµœê³  ê°ì„±</p>
                        <p id="trend-max" class="text-2xl font-bold text-green-700 mt-1">-</p>
                    </div>
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-red-600 font-medium">ìµœì € ê°ì„±</p>
                        <p id="trend-min" class="text-2xl font-bold text-red-700 mt-1">-</p>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-purple-600 font-medium">ë¶„ì„ ê¸°ê°„</p>
                        <p id="trend-period-info" class="text-lg font-bold text-purple-700 mt-1">-</p>
                    </div>
                </div>
                
                <!-- ê°ì„± íŠ¸ë Œë“œ ì°¨íŠ¸ -->
                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">ğŸ“Š ê°ì„± ì ìˆ˜ ì¶”ì´</h3>
                    <div class="relative" style="height: 300px;">
                        <canvas id="sentiment-trend-chart"></canvas>
                    </div>
                </div>
                
                <!-- ë¶€ì •ì  ê°ì„± ê¸‰ì¦ ì•Œë¦¼ -->
                <div id="spike-alert" class="hidden mb-6">
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <span class="text-2xl mr-3">âš ï¸</span>
                            <div>
                                <h4 class="text-sm font-medium text-red-800">ë¶€ì •ì  ê°ì„± ê¸‰ì¦ íƒì§€</h4>
                                <p id="spike-message" class="text-sm text-red-600 mt-1"></p>
                                <div id="spike-dates" class="flex flex-wrap gap-2 mt-2">
                                    <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì´ìŠˆë³„ íŠ¸ë Œë“œ (ì„ íƒì ) -->
                <div class="border-t pt-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">ğŸ” í‚¤ì›Œë“œ íŠ¸ë Œë“œ ê²€ìƒ‰</h3>
                    <div class="flex gap-3 mb-4">
                        <input type="text" id="keyword-search" placeholder="í‚¤ì›Œë“œ ì…ë ¥ (ì˜ˆ: ë²„ê·¸, ì—…ë°ì´íŠ¸)" 
                               class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <button onclick="loadKeywordTrend()" class="px-4 py-2 bg-gray-600 text-white text-sm rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500">
                            ê²€ìƒ‰
                        </button>
                    </div>
                    <div id="keyword-trend-container" class="hidden">
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 id="keyword-trend-title" class="text-sm font-medium text-gray-700 mb-3">í‚¤ì›Œë“œ ì–¸ê¸‰ ë¹ˆë„</h4>
                            <div class="relative" style="height: 200px;">
                                <canvas id="keyword-trend-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="trend-error" class="hidden text-center py-8">
                <svg class="w-12 h-12 text-red-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-red-500">íŠ¸ë Œë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                <button onclick="loadTrendData()" class="mt-2 text-blue-600 hover:underline">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        </div>

        <!-- ì•Œë¦¼ ì„¹ì…˜ (Requirements 8.1, 8.2, 8.3, 8.4) -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8" id="alerts-section">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-bold text-gray-800">ğŸ”” ì•Œë¦¼</h2>
                <button onclick="loadAlertsData()" class="px-4 py-2 bg-purple-600 text-white text-sm rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
            
            <div id="alerts-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"></div>
                <p class="text-gray-500 mt-2">ì•Œë¦¼ ë¡œë“œ ì¤‘...</p>
            </div>
            
            <div id="alerts-content" class="hidden">
                <!-- ì•Œë¦¼ í†µê³„ ìš”ì•½ -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <!-- ì´ ì•Œë¦¼ ìˆ˜ -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-purple-600 font-medium">ğŸ”” ì´ ì•Œë¦¼</p>
                        <p id="alerts-total" class="text-3xl font-bold text-purple-700 mt-1">-</p>
                    </div>
                    
                    <!-- ê¸´ê¸‰ ì•Œë¦¼ ìˆ˜ -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-red-600 font-medium">ğŸš¨ ê¸´ê¸‰</p>
                        <p id="alerts-urgent" class="text-3xl font-bold text-red-700 mt-1">-</p>
                    </div>
                    
                    <!-- Hot Issue ì•Œë¦¼ ìˆ˜ -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-orange-600 font-medium">ğŸ”¥ Hot Issue</p>
                        <p id="alerts-hot-issue" class="text-3xl font-bold text-orange-700 mt-1">-</p>
                    </div>
                    
                    <!-- ê°ì„± ê¸‰ì¦ ì•Œë¦¼ ìˆ˜ -->
                    <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-yellow-600 font-medium">âš ï¸ ê°ì„± ê¸‰ì¦</p>
                        <p id="alerts-sentiment-spike" class="text-3xl font-bold text-yellow-700 mt-1">-</p>
                    </div>
                </div>
                
                <!-- ì•Œë¦¼ ëª©ë¡ -->
                <div class="border-t pt-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">ğŸ“‹ ì•Œë¦¼ ëª©ë¡ (ìš°ì„ ìˆœìœ„ ìˆœ)</h3>
                    <div id="alerts-list-container">
                        <div id="alerts-empty" class="text-center py-8 text-gray-500 hidden">
                            í˜„ì¬ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                        <div id="alerts-list" class="space-y-3">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="alerts-error" class="hidden text-center py-8">
                <svg class="w-12 h-12 text-red-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-red-500">ì•Œë¦¼ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                <button onclick="loadAlertsData()" class="mt-2 text-blue-600 hover:underline">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        </div>

        <!-- Hot Post ì„¹ì…˜ (ê²Œì‹œê¸€ ê¸°ë°˜ ì´ìŠˆ íƒì§€) -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8" id="issues-section">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-lg font-bold text-gray-800">ğŸ”¥ Hot Posts (ì£¼ëª©í•  ê²Œì‹œê¸€)</h2>
                <button onclick="loadHotPostsData()" class="px-4 py-2 bg-orange-600 text-white text-sm rounded-md hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500">
                    ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
            
            <div id="issues-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"></div>
                <p class="text-gray-500 mt-2">Hot Post ë¶„ì„ ì¤‘...</p>
            </div>
            
            <div id="issues-content" class="hidden">
                <!-- Hot Post í†µê³„ ìš”ì•½ -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <!-- ì´ Hot Post ìˆ˜ -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-orange-600 font-medium">ğŸ”¥ Hot Posts</p>
                        <p id="issues-total" class="text-3xl font-bold text-orange-700 mt-1">-</p>
                    </div>
                    
                    <!-- ë²„ê·¸ ê´€ë ¨ ìˆ˜ -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-purple-600 font-medium">ğŸ› ë²„ê·¸ ê´€ë ¨</p>
                        <p id="issues-bug" class="text-3xl font-bold text-purple-700 mt-1">-</p>
                    </div>
                    
                    <!-- Critical ìˆ˜ -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-4 text-center">
                        <p class="text-sm text-red-600 font-medium">âš ï¸ Critical</p>
                        <p id="issues-critical" class="text-3xl font-bold text-red-700 mt-1">-</p>
                    </div>
                </div>
                
                <!-- Hot Post ëª©ë¡ í…Œì´ë¸” -->
                <div class="border-t pt-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">ğŸ“‹ Hot Post ëª©ë¡ (Hot Score ìˆœ)</h3>
                    <div id="issues-list-container">
                        <div id="issues-empty" class="text-center py-8 text-gray-500 hidden">
                            íƒì§€ëœ Hot Postê°€ ì—†ìŠµë‹ˆë‹¤.
                        </div>
                        <div id="issues-list" class="overflow-x-auto">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="issues-error" class="hidden text-center py-8">
                <svg class="w-12 h-12 text-red-400 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <p class="text-red-500">Hot Post ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>
                <button onclick="loadHotPostsData()" class="mt-2 text-blue-600 hover:underline">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        </div>

        <!-- í•„í„° ì„¹ì…˜ -->
        <div class="filter-section rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-lg font-bold text-gray-800 mb-4">ğŸ” í•„í„° ë° ì •ë ¬</h2>
            <form method="GET" action="/game/{{ game.game_id }}" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <!-- ê¸°ê°„ í•„í„° -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ì‹œì‘ì¼</label>
                        <input type="date" name="start_date" value="{{ filters.start_date }}"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ì¢…ë£Œì¼</label>
                        <input type="date" name="end_date" value="{{ filters.end_date }}"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <!-- ì •ë ¬ ì˜µì…˜ -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ì •ë ¬ ê¸°ì¤€</label>
                        <select name="sort" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="created_at" {% if filters.sort_by == 'created_at' %}selected{% endif %}>ì‘ì„±ì¼</option>
                            <option value="view_count" {% if filters.sort_by == 'view_count' %}selected{% endif %}>ì¡°íšŒìˆ˜</option>
                            <option value="comment_count" {% if filters.sort_by == 'comment_count' %}selected{% endif %}>ëŒ“ê¸€ìˆ˜</option>
                            <option value="sentiment_score" {% if filters.sort_by == 'sentiment_score' %}selected{% endif %}>ê°ì„± ì ìˆ˜</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ì •ë ¬ ìˆœì„œ</label>
                        <select name="order" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="desc" {% if filters.sort_order == 'desc' %}selected{% endif %}>ë‚´ë¦¼ì°¨ìˆœ</option>
                            <option value="asc" {% if filters.sort_order == 'asc' %}selected{% endif %}>ì˜¤ë¦„ì°¨ìˆœ</option>
                        </select>
                    </div>
                </div>
                
                <!-- ì‚¬ì´íŠ¸ í•„í„° -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ì‚¬ì´íŠ¸ í•„í„°</label>
                    <div class="flex flex-wrap gap-3">
                        {% for site in available_sites %}
                        <label class="inline-flex items-center">
                            <input type="checkbox" name="site" value="{{ site }}"
                                   {% if site in filters.sites %}checked{% endif %}
                                   class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <span class="ml-2 text-sm text-gray-700">{{ site }}</span>
                        </label>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- ê³ ê¸‰ í•„í„° (Requirements 5.3, 5.4, 5.5) -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-200">
                    <!-- ê°ì„± í•„í„° -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ˜Š ê°ì„± í•„í„°</label>
                        <select name="sentiment" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="" {% if not filters.sentiment %}selected{% endif %}>ì „ì²´</option>
                            <option value="positive" {% if filters.sentiment == 'positive' %}selected{% endif %}>ğŸ˜Š ê¸ì •</option>
                            <option value="neutral" {% if filters.sentiment == 'neutral' %}selected{% endif %}>ğŸ˜ ì¤‘ë¦½</option>
                            <option value="negative" {% if filters.sentiment == 'negative' %}selected{% endif %}>ğŸ˜  ë¶€ì •</option>
                        </select>
                    </div>
                    
                    <!-- ì´ìŠˆ ìœ í˜• í•„í„° (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ·ï¸ ì´ìŠˆ ìœ í˜•</label>
                        <div class="flex flex-wrap gap-2">
                            {% for issue_type in available_issue_types %}
                            <label class="inline-flex items-center">
                                <input type="checkbox" name="issue_type" value="{{ issue_type }}"
                                       {% if issue_type in filters.issue_types %}checked{% endif %}
                                       class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                <span class="ml-1 text-xs text-gray-700">{{ issue_type }}</span>
                            </label>
                            {% endfor %}
                            {% if not available_issue_types %}
                            <span class="text-xs text-gray-500">ì´ìŠˆ ë°ì´í„° ì—†ìŒ</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- ê°ì„± ì ìˆ˜ ë²”ìœ„ í•„í„° -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“Š ê°ì„± ì ìˆ˜ ë²”ìœ„</label>
                        <div class="flex gap-2">
                            <input type="number" name="sentiment_min" value="{{ filters.sentiment_min if filters.sentiment_min is not none else '' }}" 
                                   placeholder="ìµœì†Œ (-1.0)" step="0.1" min="-1" max="1"
                                   class="w-1/2 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                            <input type="number" name="sentiment_max" value="{{ filters.sentiment_max if filters.sentiment_max is not none else '' }}" 
                                   placeholder="ìµœëŒ€ (1.0)" step="0.1" min="-1" max="1"
                                   class="w-1/2 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        </div>
                    </div>
                </div>
                
                <!-- ë²„íŠ¼ -->
                <div class="flex gap-3">
                    <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        í•„í„° ì ìš©
                    </button>
                    <a href="/game/{{ game.game_id }}" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300">
                        í•„í„° ì´ˆê¸°í™”
                    </a>
                </div>
            </form>
        </div>

        <!-- ê²Œì‹œê¸€ ëª©ë¡ -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-bold text-gray-800">ğŸ“ ê²Œì‹œê¸€ ëª©ë¡</h2>
                <span class="text-sm text-gray-500">ì´ {{ "{:,}".format(stats.total_posts) }}ê°œ</span>
            </div>
            
            {% if posts %}
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì œëª©</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì‚¬ì´íŠ¸</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì‘ì„±ì¼</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì¡°íšŒìˆ˜</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ëŒ“ê¸€</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê°ì„±</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% for post in posts %}
                        <tr class="hover:bg-gray-50 cursor-pointer" onclick="window.location='/post/{{ post.url }}'">
                            <td class="px-6 py-4">
                                <div class="text-sm font-medium text-gray-900 truncate max-w-lg" title="{{ post.title }}">
                                    {{ post.title[:60] }}{% if post.title|length > 60 %}...{% endif %}
                                </div>
                                <div class="text-xs text-gray-500 mt-1">{{ post.author or 'ìµëª…' }}</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                    {% if 'inven' in post.site %}bg-blue-100 text-blue-800
                                    {% elif 'ruliweb' in post.site %}bg-green-100 text-green-800
                                    {% elif 'dcinside' in post.site %}bg-yellow-100 text-yellow-800
                                    {% else %}bg-gray-100 text-gray-800{% endif %}">
                                    {{ post.site }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {{ post.created_at[:10] if post.created_at else '-' }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {{ "{:,}".format(post.view_count or 0) }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {{ post.comments|length if post.comments else 0 }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                {% set sentiment = post.get('analysis', {}).get('sentiment', {}) %}
                                {% set label = sentiment.get('label', 'neutral') %}
                                {% set score = sentiment.get('score', 0) %}
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                    {% if label == 'positive' %}bg-green-100 text-green-800
                                    {% elif label == 'negative' %}bg-red-100 text-red-800
                                    {% else %}bg-gray-100 text-gray-800{% endif %}"
                                    title="ì ìˆ˜: {{ '%.2f'|format(score) }}">
                                    {% if label == 'positive' %}ğŸ˜Š
                                    {% elif label == 'negative' %}ğŸ˜ 
                                    {% else %}ğŸ˜{% endif %}
                                    {{ '%.1f'|format(score) }}
                                </span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <!-- í˜ì´ì§€ë„¤ì´ì…˜ ì•ˆë‚´ -->
            {% if posts|length >= 50 %}
            <div class="mt-4 text-center text-sm text-gray-500">
                ë” ë§ì€ ê²Œì‹œê¸€ì„ ë³´ë ¤ë©´ APIë¥¼ ì‚¬ìš©í•˜ì„¸ìš”: <code class="bg-gray-100 px-2 py-1 rounded">/api/game/{{ game.game_id }}/posts?limit=100&offset=50</code>
            </div>
            {% endif %}
            
            {% else %}
            <div class="text-center py-12">
                <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <p class="text-gray-500">í•„í„° ì¡°ê±´ì— ë§ëŠ” ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                <a href="/game/{{ game.game_id }}" class="text-blue-600 hover:underline mt-2 inline-block">í•„í„° ì´ˆê¸°í™”</a>
            </div>
            {% endif %}
        </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="bg-gray-800 text-white py-4 mt-8">
        <div class="container mx-auto px-4 text-center">
            <p>{{ game.name }} ì»¤ë®¤ë‹ˆí‹° ë¶„ì„ ëŒ€ì‹œë³´ë“œ</p>
        </div>
    </footer>

    <!-- ê°ì„± ë¶„ì„ JavaScript -->
    <script>
        let sentimentChart = null;
        const gameId = '{{ game.game_id }}';
        
        // í˜„ì¬ í•„í„° ì¡°ê±´ ê°€ì ¸ì˜¤ê¸°
        function getCurrentFilters() {
            const params = new URLSearchParams(window.location.search);
            const filters = {};
            
            if (params.get('start_date')) filters.start_date = params.get('start_date');
            if (params.get('end_date')) filters.end_date = params.get('end_date');
            
            const sites = params.getAll('site');
            if (sites.length > 0) filters.sites = sites;
            
            return filters;
        }
        
        // ê°ì„± ë¶„ì„ ë°ì´í„° ë¡œë“œ
        async function loadSentimentData() {
            const loadingEl = document.getElementById('sentiment-loading');
            const contentEl = document.getElementById('sentiment-content');
            const errorEl = document.getElementById('sentiment-error');
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            loadingEl.classList.remove('hidden');
            contentEl.classList.add('hidden');
            errorEl.classList.add('hidden');
            
            try {
                // í•„í„° ì¡°ê±´ ì ìš©
                const filters = getCurrentFilters();
                let url = `/api/game/${gameId}/sentiment`;
                const params = new URLSearchParams();
                
                if (filters.start_date) params.append('start_date', filters.start_date);
                if (filters.end_date) params.append('end_date', filters.end_date);
                if (filters.sites) {
                    filters.sites.forEach(site => params.append('site', site));
                }
                
                if (params.toString()) {
                    url += '?' + params.toString();
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const data = await response.json();
                
                // ë°ì´í„° í‘œì‹œ
                displaySentimentData(data);
                
                // ë¡œë”© ì™„ë£Œ
                loadingEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('ê°ì„± ë¶„ì„ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                loadingEl.classList.add('hidden');
                errorEl.classList.remove('hidden');
            }
        }
        
        // ê°ì„± ë¶„ì„ ë°ì´í„° í‘œì‹œ
        function displaySentimentData(data) {
            const dist = data.sentiment_distribution;
            const total = data.total_analyzed;
            
            // í‰ê·  ì ìˆ˜ í‘œì‹œ
            const avgEl = document.getElementById('sentiment-avg');
            const avgLabelEl = document.getElementById('sentiment-avg-label');
            avgEl.textContent = data.sentiment_avg.toFixed(2);
            
            // í‰ê·  ì ìˆ˜ì— ë”°ë¥¸ ë ˆì´ë¸”
            let avgLabel = 'ì¤‘ë¦½';
            if (data.sentiment_avg > 0.1) avgLabel = 'ê¸ì •ì ';
            else if (data.sentiment_avg < -0.1) avgLabel = 'ë¶€ì •ì ';
            avgLabelEl.textContent = avgLabel;
            
            // ìƒ‰ìƒ ë³€ê²½
            if (data.sentiment_avg > 0.1) {
                avgEl.classList.remove('text-indigo-700', 'text-red-700');
                avgEl.classList.add('text-green-700');
            } else if (data.sentiment_avg < -0.1) {
                avgEl.classList.remove('text-indigo-700', 'text-green-700');
                avgEl.classList.add('text-red-700');
            }
            
            // ë¶„í¬ ìˆ˜ì¹˜ í‘œì‹œ
            document.getElementById('sentiment-positive').textContent = dist.positive.toLocaleString();
            document.getElementById('sentiment-neutral').textContent = dist.neutral.toLocaleString();
            document.getElementById('sentiment-negative').textContent = dist.negative.toLocaleString();
            
            // ë°±ë¶„ìœ¨ ê³„ì‚° ë° í‘œì‹œ
            const positivePct = total > 0 ? ((dist.positive / total) * 100).toFixed(1) : 0;
            const neutralPct = total > 0 ? ((dist.neutral / total) * 100).toFixed(1) : 0;
            const negativePct = total > 0 ? ((dist.negative / total) * 100).toFixed(1) : 0;
            
            document.getElementById('sentiment-positive-pct').textContent = `${positivePct}%`;
            document.getElementById('sentiment-neutral-pct').textContent = `${neutralPct}%`;
            document.getElementById('sentiment-negative-pct').textContent = `${negativePct}%`;
            
            // ë°” ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('bar-positive').style.width = `${positivePct}%`;
            document.getElementById('bar-neutral').style.width = `${neutralPct}%`;
            document.getElementById('bar-negative').style.width = `${negativePct}%`;
            document.getElementById('bar-positive-pct').textContent = `${positivePct}%`;
            document.getElementById('bar-neutral-pct').textContent = `${neutralPct}%`;
            document.getElementById('bar-negative-pct').textContent = `${negativePct}%`;
            
            // ë„ë„› ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateSentimentChart(dist);
            
            // ë¶€ì •ì  ê²Œì‹œê¸€ ëª©ë¡ í‘œì‹œ
            displayNegativePosts(data.negative_posts);
        }
        
        // ê°ì„± ë¶„í¬ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateSentimentChart(dist) {
            const ctx = document.getElementById('sentiment-chart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (sentimentChart) {
                sentimentChart.destroy();
            }
            
            // ìƒˆ ì°¨íŠ¸ ìƒì„±
            sentimentChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ê¸ì •', 'ì¤‘ë¦½', 'ë¶€ì •'],
                    datasets: [{
                        data: [dist.positive, dist.neutral, dist.negative],
                        backgroundColor: [
                            'rgba(34, 197, 94, 0.8)',   // green-500
                            'rgba(156, 163, 175, 0.8)', // gray-400
                            'rgba(239, 68, 68, 0.8)'    // red-500
                        ],
                        borderColor: [
                            'rgba(34, 197, 94, 1)',
                            'rgba(156, 163, 175, 1)',
                            'rgba(239, 68, 68, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const value = context.raw;
                                    const pct = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${context.label}: ${value.toLocaleString()}ê°œ (${pct}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // ë¶€ì •ì  ê²Œì‹œê¸€ ëª©ë¡ í‘œì‹œ
        function displayNegativePosts(posts) {
            const listEl = document.getElementById('negative-posts-list');
            const emptyEl = document.getElementById('negative-posts-empty');
            
            if (!posts || posts.length === 0) {
                listEl.innerHTML = '';
                emptyEl.classList.remove('hidden');
                return;
            }
            
            emptyEl.classList.add('hidden');
            
            listEl.innerHTML = posts.map(post => `
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 hover:bg-red-100 transition-colors cursor-pointer"
                     onclick="window.location='/post/${encodeURIComponent(post.url)}'">
                    <div class="flex items-start justify-between">
                        <div class="flex-1 min-w-0">
                            <h4 class="text-sm font-medium text-gray-900 truncate" title="${escapeHtml(post.title)}">
                                ${escapeHtml(post.title.length > 60 ? post.title.substring(0, 60) + '...' : post.title)}
                            </h4>
                            <div class="flex items-center gap-3 mt-1 text-xs text-gray-500">
                                <span>${post.site}</span>
                                <span>${post.created_at ? post.created_at.substring(0, 10) : '-'}</span>
                                <span>ì¡°íšŒ ${(post.view_count || 0).toLocaleString()}</span>
                                <span>ëŒ“ê¸€ ${post.comment_count || 0}</span>
                            </div>
                        </div>
                        <div class="ml-4 flex-shrink-0 text-right">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                ${post.sentiment_score.toFixed(2)}
                            </span>
                            <p class="text-xs text-gray-500 mt-1">ì‹ ë¢°ë„ ${(post.confidence * 100).toFixed(0)}%</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê°ì„± ë¶„ì„ ë°ì´í„° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            loadSentimentData();
            loadHotPostsData();
        });
        
        // Hot Post ë°ì´í„° ë¡œë“œ (ê²Œì‹œê¸€ ê¸°ë°˜)
        async function loadHotPostsData() {
            const loadingEl = document.getElementById('issues-loading');
            const contentEl = document.getElementById('issues-content');
            const errorEl = document.getElementById('issues-error');
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            loadingEl.classList.remove('hidden');
            contentEl.classList.add('hidden');
            errorEl.classList.add('hidden');
            
            try {
                // í•„í„° ì¡°ê±´ ì ìš©
                const filters = getCurrentFilters();
                let url = `/api/game/${gameId}/hot-posts`;
                const params = new URLSearchParams();
                
                if (filters.start_date) params.append('start_date', filters.start_date);
                if (filters.end_date) params.append('end_date', filters.end_date);
                if (filters.sites) {
                    filters.sites.forEach(site => params.append('site', site));
                }
                params.append('limit', '30');
                
                if (params.toString()) {
                    url += '?' + params.toString();
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const data = await response.json();
                
                // ë°ì´í„° í‘œì‹œ
                displayHotPostsData(data);
                
                // Hot Post ë°°ë„ˆ í‘œì‹œ
                if (data.alert_message) {
                    displayHotPostBanner(data);
                }
                
                // ë¡œë”© ì™„ë£Œ
                loadingEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('Hot Post ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                loadingEl.classList.add('hidden');
                errorEl.classList.remove('hidden');
            }
        }
        
        // Hot Post ë°ì´í„° í‘œì‹œ
        function displayHotPostsData(data) {
            // í†µê³„ í‘œì‹œ
            document.getElementById('issues-total').textContent = data.total_hot_posts.toLocaleString();
            document.getElementById('issues-bug').textContent = data.bug_count.toLocaleString();
            document.getElementById('issues-critical').textContent = data.critical_count.toLocaleString();
            
            // Hot Post ëª©ë¡ í‘œì‹œ
            displayHotPostsList(data.hot_posts);
        }
        
        // Hot Post ëª©ë¡ í…Œì´ë¸” í‘œì‹œ
        function displayHotPostsList(hotPosts) {
            const listEl = document.getElementById('issues-list');
            const emptyEl = document.getElementById('issues-empty');
            
            if (!hotPosts || hotPosts.length === 0) {
                listEl.innerHTML = '';
                emptyEl.classList.remove('hidden');
                return;
            }
            
            emptyEl.classList.add('hidden');
            
            // í…Œì´ë¸” ìƒì„±
            let tableHtml = `
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ìƒíƒœ</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì œëª©</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">í‚¤ì›Œë“œ</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hot Score</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ì¡°íšŒìˆ˜</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ëŒ“ê¸€</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ê°ì„±</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
            `;
            
            hotPosts.forEach((post, index) => {
                // ìƒíƒœ ë°°ì§€
                let statusBadges = '';
                if (post.hot_score >= 0.7) {
                    statusBadges += '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800 mr-1">ğŸ”¥ HOT</span>';
                } else if (post.hot_score >= 0.5) {
                    statusBadges += '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800 mr-1">âš ï¸ ì£¼ëª©</span>';
                }
                if (post.is_bug) {
                    statusBadges += `<span class="px-2 py-1 text-xs font-semibold rounded-full ${getSeverityColor(post.severity)} mr-1">ğŸ› ${post.severity.toUpperCase()}</span>`;
                }
                if (!statusBadges) {
                    statusBadges = '<span class="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-600">ì¼ë°˜</span>';
                }
                
                // Hot Score ë°”
                const hotScorePct = Math.min(100, post.hot_score * 100);
                const hotScoreColor = post.hot_score >= 0.7 ? 'bg-red-500' : (post.hot_score >= 0.5 ? 'bg-orange-500' : 'bg-blue-500');
                
                // ê°ì„± ì ìˆ˜ ìƒ‰ìƒ
                const sentimentColor = post.sentiment_score > 0.1 ? 'text-green-600' : (post.sentiment_score < -0.1 ? 'text-red-600' : 'text-gray-600');
                
                // í‚¤ì›Œë“œ íƒœê·¸
                const keywordTags = (post.keywords || []).slice(0, 3).map(kw => 
                    `<span class="inline-block px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded mr-1 mb-1">${escapeHtml(kw)}</span>`
                ).join('');
                
                // í–‰ ë°°ê²½ìƒ‰ (Hot PostëŠ” ê°•ì¡°)
                const rowBg = post.hot_score >= 0.7 ? 'bg-red-50 hover:bg-red-100' : (post.hot_score >= 0.5 ? 'bg-orange-50 hover:bg-orange-100' : 'hover:bg-gray-50');
                
                // ì œëª© (í´ë¦­ ê°€ëŠ¥)
                const titlePreview = post.title.length > 50 ? post.title.substring(0, 50) + '...' : post.title;
                
                tableHtml += `
                    <tr class="${rowBg} cursor-pointer" onclick="window.location='/post/${encodeURIComponent(post.post_url)}'">
                        <td class="px-4 py-3 whitespace-nowrap">
                            ${statusBadges}
                        </td>
                        <td class="px-4 py-3">
                            <div class="text-sm font-medium text-gray-900" title="${escapeHtml(post.title)}">${escapeHtml(titlePreview)}</div>
                            <div class="text-xs text-gray-500 mt-1">
                                ${post.site} | ${post.author || 'ìµëª…'} | ${post.created_at ? post.created_at.substring(0, 10) : '-'}
                            </div>
                        </td>
                        <td class="px-4 py-3">
                            <div class="flex flex-wrap max-w-xs">
                                ${keywordTags || '<span class="text-xs text-gray-400">-</span>'}
                            </div>
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                    <div class="${hotScoreColor} h-2 rounded-full" style="width: ${hotScorePct}%"></div>
                                </div>
                                <span class="text-sm text-gray-600">${(post.hot_score * 100).toFixed(1)}%</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">
                            ${(post.view_count || 0).toLocaleString()}
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">
                            ${(post.comment_count || 0).toLocaleString()}
                        </td>
                        <td class="px-4 py-3 whitespace-nowrap">
                            <span class="text-sm font-medium ${sentimentColor}">
                                ${post.sentiment_score > 0 ? '+' : ''}${post.sentiment_score.toFixed(2)}
                            </span>
                        </td>
                    </tr>
                `;
            });
            
            tableHtml += `
                    </tbody>
                </table>
            `;
            
            listEl.innerHTML = tableHtml;
        }
        
        // ì‹¬ê°ë„ì— ë”°ë¥¸ ìƒ‰ìƒ ë°˜í™˜
        function getSeverityColor(severity) {
            switch (severity) {
                case 'critical': return 'bg-red-200 text-red-900';
                case 'high': return 'bg-orange-200 text-orange-900';
                case 'medium': return 'bg-yellow-200 text-yellow-900';
                case 'low': return 'bg-green-200 text-green-900';
                default: return 'bg-gray-200 text-gray-900';
            }
        }
        
        // Hot Post ë°°ë„ˆ í‘œì‹œ
        function displayHotPostBanner(data) {
            const bannerEl = document.getElementById('hot-issue-banner');
            const messageEl = document.getElementById('hot-issue-message');
            const detailEl = document.getElementById('hot-issue-detail');
            const postsEl = document.getElementById('hot-issue-posts');
            
            // ë°°ë„ˆê°€ ì´ë¯¸ ë‹«í˜”ëŠ”ì§€ í™•ì¸ (ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€)
            const dismissedKey = `hot_post_dismissed_${gameId}`;
            if (sessionStorage.getItem(dismissedKey)) {
                return;
            }
            
            // ë©”ì‹œì§€ ì„¤ì •
            if (data.alert_message) {
                messageEl.textContent = data.alert_message;
            } else if (data.total_hot_posts > 0) {
                messageEl.textContent = `ğŸ”¥ ${data.total_hot_posts}ê°œì˜ ì£¼ëª©í•  ê²Œì‹œê¸€ì´ ìˆìŠµë‹ˆë‹¤!`;
            } else {
                return; // í‘œì‹œí•  ë‚´ìš© ì—†ìŒ
            }
            
            // ìƒì„¸ ì •ë³´ ì„¤ì •
            if (data.hot_posts && data.hot_posts.length > 0) {
                const topPost = data.hot_posts[0];
                detailEl.textContent = `ì¡°íšŒìˆ˜ ${(topPost.view_count || 0).toLocaleString()} | ëŒ“ê¸€ ${topPost.comment_count || 0}ê°œ | ê°ì„± ì ìˆ˜ ${topPost.sentiment_score.toFixed(2)}`;
                
                // ê´€ë ¨ ê²Œì‹œê¸€ ë§í¬ í‘œì‹œ
                postsEl.classList.remove('hidden');
                postsEl.innerHTML = `
                    <span class="text-red-200">Hot Posts:</span>
                    ${data.hot_posts.slice(0, 3).map(post => `
                        <a href="/post/${encodeURIComponent(post.post_url)}" 
                           class="px-2 py-0.5 bg-red-500 bg-opacity-30 rounded hover:bg-opacity-50 transition-colors truncate max-w-xs"
                           title="${escapeHtml(post.title)}">
                            ${escapeHtml(post.title.length > 30 ? post.title.substring(0, 30) + '...' : post.title)}
                        </a>
                    `).join('')}
                `;
            }
            
            // ë°°ë„ˆ í‘œì‹œ
            bannerEl.classList.remove('hidden');
        }
        
        // Hot Issue ë°°ë„ˆ ë‹«ê¸°
        function dismissHotIssueBanner() {
            const bannerEl = document.getElementById('hot-issue-banner');
            bannerEl.classList.add('hidden');
            
            // ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ë‹«í˜ ìƒíƒœ ì €ì¥
            const dismissedKey = `hot_post_dismissed_${gameId}`;
            sessionStorage.setItem(dismissedKey, 'true');
        }
        
        // ì´ìŠˆ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function scrollToIssues() {
            const issuesSection = document.getElementById('issues-section');
            if (issuesSection) {
                issuesSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // ì•Œë¦¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function scrollToAlerts() {
            const alertsSection = document.getElementById('alerts-section');
            if (alertsSection) {
                alertsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // íŠ¸ë Œë“œ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        function scrollToTrend() {
            const trendSection = document.getElementById('trend-section');
            if (trendSection) {
                trendSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // ê¸´ê¸‰ ì•Œë¦¼ ë°°ë„ˆ ë‹«ê¸°
        function dismissUrgentAlertBanner() {
            const bannerEl = document.getElementById('urgent-alert-banner');
            bannerEl.classList.add('hidden');
            const dismissedKey = `urgent_alert_dismissed_${gameId}`;
            sessionStorage.setItem(dismissedKey, 'true');
        }
        
        // ê°ì„± ê¸‰ì¦ ë°°ë„ˆ ë‹«ê¸°
        function dismissSentimentSpikeBanner() {
            const bannerEl = document.getElementById('sentiment-spike-banner');
            bannerEl.classList.add('hidden');
            const dismissedKey = `sentiment_spike_dismissed_${gameId}`;
            sessionStorage.setItem(dismissedKey, 'true');
        }
        
        // ì•Œë¦¼ ë°ì´í„° ë¡œë“œ (Requirements 8.1, 8.2, 8.3, 8.4)
        async function loadAlertsData() {
            const loadingEl = document.getElementById('alerts-loading');
            const contentEl = document.getElementById('alerts-content');
            const errorEl = document.getElementById('alerts-error');
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            loadingEl.classList.remove('hidden');
            contentEl.classList.add('hidden');
            errorEl.classList.add('hidden');
            
            try {
                // í•„í„° ì¡°ê±´ ì ìš©
                const filters = getCurrentFilters();
                let url = `/api/game/${gameId}/alerts`;
                const params = new URLSearchParams();
                
                if (filters.start_date) params.append('start_date', filters.start_date);
                if (filters.end_date) params.append('end_date', filters.end_date);
                if (filters.sites) {
                    filters.sites.forEach(site => params.append('site', site));
                }
                
                if (params.toString()) {
                    url += '?' + params.toString();
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const data = await response.json();
                
                // ë°ì´í„° í‘œì‹œ
                displayAlertsData(data);
                
                // ë°°ë„ˆ í‘œì‹œ
                displayAlertBanners(data);
                
                // ë¡œë”© ì™„ë£Œ
                loadingEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('ì•Œë¦¼ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                loadingEl.classList.add('hidden');
                errorEl.classList.remove('hidden');
            }
        }
        
        // ì•Œë¦¼ ë°ì´í„° í‘œì‹œ
        function displayAlertsData(data) {
            const summary = data.summary;
            
            // í†µê³„ ìš”ì•½ í‘œì‹œ
            document.getElementById('alerts-total').textContent = summary.total_alerts;
            document.getElementById('alerts-urgent').textContent = summary.urgent_count;
            document.getElementById('alerts-hot-issue').textContent = summary.hot_issue_count;
            document.getElementById('alerts-sentiment-spike').textContent = summary.sentiment_spike_count;
            
            // ì•Œë¦¼ ëª©ë¡ í‘œì‹œ
            const listEl = document.getElementById('alerts-list');
            const emptyEl = document.getElementById('alerts-empty');
            
            if (!data.alerts || data.alerts.length === 0) {
                listEl.innerHTML = '';
                emptyEl.classList.remove('hidden');
                return;
            }
            
            emptyEl.classList.add('hidden');
            
            // ì•Œë¦¼ ì¹´ë“œ ìƒì„±
            listEl.innerHTML = data.alerts.map(alert => {
                const priorityColor = getAlertPriorityColor(alert.priority);
                const typeIcon = getAlertTypeIcon(alert.alert_type);
                const createdAt = alert.created_at ? alert.created_at.substring(0, 16).replace('T', ' ') : '-';
                
                // ê´€ë ¨ ê²Œì‹œê¸€ ë§í¬
                let relatedPostsHtml = '';
                if (alert.related_posts && alert.related_posts.length > 0) {
                    relatedPostsHtml = `
                        <div class="mt-2 flex flex-wrap gap-1">
                            ${alert.related_posts.slice(0, 3).map(url => `
                                <a href="/post/${encodeURIComponent(url)}" 
                                   class="text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded hover:bg-gray-200 transition-colors truncate max-w-xs"
                                   title="${escapeHtml(url)}">
                                    ğŸ“„ ê´€ë ¨ ê²Œì‹œê¸€
                                </a>
                            `).join('')}
                            ${alert.related_posts.length > 3 ? `<span class="text-xs text-gray-400">+${alert.related_posts.length - 3}ê°œ</span>` : ''}
                        </div>
                    `;
                }
                
                return `
                    <div class="border rounded-lg p-4 ${alert.is_urgent ? 'border-red-300 bg-red-50' : 'border-gray-200 bg-white'} hover:shadow-md transition-shadow">
                        <div class="flex items-start justify-between">
                            <div class="flex items-start">
                                <span class="text-2xl mr-3">${typeIcon}</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">${escapeHtml(alert.title)}</h4>
                                    <p class="text-sm text-gray-600 mt-1">${escapeHtml(alert.message)}</p>
                                    ${relatedPostsHtml}
                                </div>
                            </div>
                            <div class="flex flex-col items-end">
                                <span class="px-2 py-1 text-xs font-medium rounded ${priorityColor}">
                                    ${alert.priority.toUpperCase()}
                                </span>
                                <span class="text-xs text-gray-400 mt-1">${createdAt}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        // ì•Œë¦¼ ë°°ë„ˆ í‘œì‹œ
        function displayAlertBanners(data) {
            // ê¸´ê¸‰ ì•Œë¦¼ ë°°ë„ˆ
            const urgentBannerEl = document.getElementById('urgent-alert-banner');
            const urgentDismissedKey = `urgent_alert_dismissed_${gameId}`;
            
            if (data.summary.urgent_count > 0 && !sessionStorage.getItem(urgentDismissedKey)) {
                const urgentAlert = data.alerts.find(a => a.is_urgent);
                if (urgentAlert) {
                    document.getElementById('urgent-alert-message').textContent = urgentAlert.title;
                    document.getElementById('urgent-alert-detail').textContent = urgentAlert.message;
                    urgentBannerEl.classList.remove('hidden');
                }
            }
            
            // ê°ì„± ê¸‰ì¦ ë°°ë„ˆ
            const spikeBannerEl = document.getElementById('sentiment-spike-banner');
            const spikeDismissedKey = `sentiment_spike_dismissed_${gameId}`;
            
            if (data.summary.sentiment_spike_count > 0 && !sessionStorage.getItem(spikeDismissedKey)) {
                const spikeAlert = data.alerts.find(a => a.alert_type === 'sentiment_spike');
                if (spikeAlert) {
                    document.getElementById('sentiment-spike-message').textContent = spikeAlert.title;
                    document.getElementById('sentiment-spike-detail').textContent = spikeAlert.message;
                    spikeBannerEl.classList.remove('hidden');
                }
            }
        }
        
        // ì•Œë¦¼ ìš°ì„ ìˆœìœ„ ìƒ‰ìƒ ë°˜í™˜
        function getAlertPriorityColor(priority) {
            switch (priority) {
                case 'critical': return 'bg-red-200 text-red-900';
                case 'high': return 'bg-orange-200 text-orange-900';
                case 'medium': return 'bg-yellow-200 text-yellow-900';
                case 'low': return 'bg-green-200 text-green-900';
                default: return 'bg-gray-200 text-gray-900';
            }
        }
        
        // ì•Œë¦¼ ìœ í˜• ì•„ì´ì½˜ ë°˜í™˜
        function getAlertTypeIcon(alertType) {
            switch (alertType) {
                case 'hot_issue': return 'ğŸ”¥';
                case 'sentiment_spike': return 'âš ï¸';
                case 'urgent': return 'ğŸš¨';
                case 'bug_critical': return 'ğŸ›';
                default: return 'ğŸ””';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', function() {
            loadSentimentData();
            loadTrendData();
            loadHotPostsData();
            loadAlertsData();
        });
        
        // íŠ¸ë Œë“œ ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤
        let sentimentTrendChart = null;
        let keywordTrendChart = null;
        
        // íŠ¸ë Œë“œ ë°ì´í„° ë¡œë“œ
        async function loadTrendData() {
            const loadingEl = document.getElementById('trend-loading');
            const contentEl = document.getElementById('trend-content');
            const errorEl = document.getElementById('trend-error');
            
            // ë¡œë”© ìƒíƒœ í‘œì‹œ
            loadingEl.classList.remove('hidden');
            contentEl.classList.add('hidden');
            errorEl.classList.add('hidden');
            
            try {
                // í•„í„° ì¡°ê±´ ì ìš©
                const filters = getCurrentFilters();
                const period = document.getElementById('trend-period').value;
                let url = `/api/game/${gameId}/sentiment/trend`;
                const params = new URLSearchParams();
                
                if (filters.start_date) params.append('start_date', filters.start_date);
                if (filters.end_date) params.append('end_date', filters.end_date);
                if (filters.sites) {
                    filters.sites.forEach(site => params.append('site', site));
                }
                params.append('period', period);
                
                if (params.toString()) {
                    url += '?' + params.toString();
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const data = await response.json();
                
                // ë°ì´í„° í‘œì‹œ
                displayTrendData(data);
                
                // ë¡œë”© ì™„ë£Œ
                loadingEl.classList.add('hidden');
                contentEl.classList.remove('hidden');
                
            } catch (error) {
                console.error('íŠ¸ë Œë“œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                loadingEl.classList.add('hidden');
                errorEl.classList.remove('hidden');
            }
        }
        
        // íŠ¸ë Œë“œ ë°ì´í„° í‘œì‹œ
        function displayTrendData(data) {
            const summary = data.summary;
            
            // ìš”ì•½ ì •ë³´ í‘œì‹œ
            document.getElementById('trend-avg').textContent = summary.avg_value.toFixed(2);
            document.getElementById('trend-max').textContent = summary.max_value.toFixed(2);
            document.getElementById('trend-min').textContent = summary.min_value.toFixed(2);
            
            // ê¸°ê°„ ì •ë³´
            if (summary.start_date && summary.end_date) {
                const startDate = summary.start_date.substring(0, 10);
                const endDate = summary.end_date.substring(0, 10);
                document.getElementById('trend-period-info').textContent = `${startDate} ~ ${endDate}`;
            } else {
                document.getElementById('trend-period-info').textContent = '-';
            }
            
            // í‰ê·  ê°ì„±ì— ë”°ë¥¸ ìƒ‰ìƒ ë³€ê²½
            const avgEl = document.getElementById('trend-avg');
            avgEl.classList.remove('text-indigo-700', 'text-green-700', 'text-red-700');
            if (summary.avg_value > 0.1) {
                avgEl.classList.add('text-green-700');
            } else if (summary.avg_value < -0.1) {
                avgEl.classList.add('text-red-700');
            } else {
                avgEl.classList.add('text-indigo-700');
            }
            
            // íŠ¸ë Œë“œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateSentimentTrendChart(data.trend);
            
            // ë¶€ì •ì  ê°ì„± ê¸‰ì¦ ì•Œë¦¼
            displaySpikeAlert(data.spikes);
        }
        
        // ê°ì„± íŠ¸ë Œë“œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateSentimentTrendChart(trend) {
            const ctx = document.getElementById('sentiment-trend-chart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (sentimentTrendChart) {
                sentimentTrendChart.destroy();
            }
            
            const labels = trend.data_points.map(p => p.date);
            const values = trend.data_points.map(p => p.value);
            const counts = trend.data_points.map(p => p.count);
            
            // ìƒ‰ìƒ ë°°ì—´ ìƒì„± (ê°’ì— ë”°ë¼)
            const backgroundColors = values.map(v => {
                if (v > 0.1) return 'rgba(34, 197, 94, 0.6)';  // ê¸ì • - ë…¹ìƒ‰
                if (v < -0.1) return 'rgba(239, 68, 68, 0.6)'; // ë¶€ì • - ë¹¨ê°„ìƒ‰
                return 'rgba(156, 163, 175, 0.6)';             // ì¤‘ë¦½ - íšŒìƒ‰
            });
            
            const borderColors = values.map(v => {
                if (v > 0.1) return 'rgba(34, 197, 94, 1)';
                if (v < -0.1) return 'rgba(239, 68, 68, 1)';
                return 'rgba(156, 163, 175, 1)';
            });
            
            // ìƒˆ ì°¨íŠ¸ ìƒì„±
            sentimentTrendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ê°ì„± ì ìˆ˜',
                        data: values,
                        borderColor: 'rgba(99, 102, 241, 1)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: backgroundColors,
                        pointBorderColor: borderColors,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const idx = context.dataIndex;
                                    const value = context.raw;
                                    const count = counts[idx];
                                    let label = value > 0.1 ? 'ê¸ì •' : (value < -0.1 ? 'ë¶€ì •' : 'ì¤‘ë¦½');
                                    return `ê°ì„± ì ìˆ˜: ${value.toFixed(3)} (${label}) | ê²Œì‹œê¸€: ${count}ê°œ`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            min: -1,
                            max: 1,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toFixed(1);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // ë¶€ì •ì  ê°ì„± ê¸‰ì¦ ì•Œë¦¼ í‘œì‹œ
        function displaySpikeAlert(spikes) {
            const alertEl = document.getElementById('spike-alert');
            const messageEl = document.getElementById('spike-message');
            const datesEl = document.getElementById('spike-dates');
            
            if (!spikes || spikes.length === 0) {
                alertEl.classList.add('hidden');
                return;
            }
            
            alertEl.classList.remove('hidden');
            messageEl.textContent = `${spikes.length}ê°œ ë‚ ì§œì—ì„œ ë¶€ì •ì  ê°ì„± ê¸‰ì¦ì´ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤. (ê°ì„± ì ìˆ˜ -0.3 ë¯¸ë§Œ)`;
            
            datesEl.innerHTML = spikes.map(spike => `
                <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">
                    ${spike.date}: ${spike.value.toFixed(2)} (${spike.count}ê°œ)
                </span>
            `).join('');
        }
        
        // í‚¤ì›Œë“œ íŠ¸ë Œë“œ ë¡œë“œ
        async function loadKeywordTrend() {
            const keyword = document.getElementById('keyword-search').value.trim();
            if (!keyword) {
                alert('í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const containerEl = document.getElementById('keyword-trend-container');
            const titleEl = document.getElementById('keyword-trend-title');
            
            try {
                // í•„í„° ì¡°ê±´ ì ìš©
                const filters = getCurrentFilters();
                const period = document.getElementById('trend-period').value;
                let url = `/api/game/${gameId}/keyword/${encodeURIComponent(keyword)}/trend`;
                const params = new URLSearchParams();
                
                if (filters.start_date) params.append('start_date', filters.start_date);
                if (filters.end_date) params.append('end_date', filters.end_date);
                if (filters.sites) {
                    filters.sites.forEach(site => params.append('site', site));
                }
                params.append('period', period);
                
                if (params.toString()) {
                    url += '?' + params.toString();
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error('API ìš”ì²­ ì‹¤íŒ¨');
                
                const data = await response.json();
                
                // ì»¨í…Œì´ë„ˆ í‘œì‹œ
                containerEl.classList.remove('hidden');
                titleEl.textContent = `"${keyword}" í‚¤ì›Œë“œ ì–¸ê¸‰ ë¹ˆë„`;
                
                // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                updateKeywordTrendChart(data.trend);
                
            } catch (error) {
                console.error('í‚¤ì›Œë“œ íŠ¸ë Œë“œ ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('í‚¤ì›Œë“œ íŠ¸ë Œë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í‚¤ì›Œë“œ íŠ¸ë Œë“œ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateKeywordTrendChart(trend) {
            const ctx = document.getElementById('keyword-trend-chart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (keywordTrendChart) {
                keywordTrendChart.destroy();
            }
            
            const labels = trend.data_points.map(p => p.date);
            const values = trend.data_points.map(p => p.value);
            
            // ìƒˆ ì°¨íŠ¸ ìƒì„±
            keywordTrendChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì–¸ê¸‰ íšŸìˆ˜',
                        data: values,
                        backgroundColor: 'rgba(99, 102, 241, 0.6)',
                        borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `ì–¸ê¸‰ íšŸìˆ˜: ${context.raw}íšŒ`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                maxRotation: 45,
                                minRotation: 45
                            }
                        },
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        // í‚¤ì›Œë“œ ê²€ìƒ‰ ì—”í„°í‚¤ ì§€ì›
        document.getElementById('keyword-search').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loadKeywordTrend();
            }
        });
    </script>
</body>
</html>
